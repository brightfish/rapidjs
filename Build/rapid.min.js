var AngularPromiseFactory=(function(){function a(b){this.$q=b}a.prototype.Defer=function(){return this.$q.defer()};return a})();var AngularTransporter=(function(){function a(b){this.$http=b}a.prototype.Get=function(c,b){return this.$http.get(c)};a.prototype.Post=function(c,b){return this.$http.post(c,b)};a.prototype.Put=function(c,b){return this.$http.put(c,b)};a.prototype.Delete=function(c,b){return this.$http.delete(c,b)};a.prototype.Patch=function(c,b){return this.$http.patch(c,b)};a.prototype.Batch=function(c,b){};return a})();var Context=(function(){function a(){this.Dispose=function(){};this.Tracker=DependencyResolver.Current.Get("Tracker");this.PromiseFactory=DependencyResolver.Current.Get("PromiseFactory");this.Transporter=DependencyResolver.Current.Get("Transporter");this.XmlSerializer=DependencyResolver.Current.Get("XmlSerializer");this.Serializer=DependencyResolver.Current.Get("Serializer");this.Router=DependencyResolver.Current.Get("Router");this.MetadataProvider=DependencyResolver.Current.Get("MetadataProvider")}a.prototype.SaveChanges=function(){};a.prototype.Initialize=function(){var c=this.PromiseFactory.Defer();var b=this.MetadataProvider.Process();b.Then(function(d){this.MetadataProvider.BuildContext(self);c.Resolve()},function(d){c.Reject();alert(d)});return c.Promise};return a})();var DependencyResolver=(function(){function a(){}a.prototype.Set=function(b,c){if(!c){throw"Dependency {name} is null or undefined. ".replace("{name}",b)}this.dependencies[b]=c};a.prototype.Get=function(c){var b=this.dependencies[c];if(!b){throw"Dependency {name} does not exist. ".replace("{name}",c)}return b.Create()};a.prototype.GetFactory=function(c){var b=this.dependencies[c];if(!b){throw"Dependency {name} does not exist. ".replace("{name}",c)}return b};a.prototype.Remove=function(b){delete this.dependencies[b]};return a})();var Factory=(function(){function a(){}a.prototype.Create=function(b){return new b()};return a})();var JsonSerializer=function(){var a=this;a.Serialize=function(b){return JSON.stringify(b)};a.Deserialize=function(b){return JSON.parse(b)};return a};var MetadataProvider=(function(){function a(){this.Router=DependencyResolver.Current.Get("Router");this.Transporter=DependencyResolver.Current.Get("Transporter");this.PromiseFactory=DependencyResolver.Current.Get("PromiseFactory");this.XmlSerializer=DependencyResolver.Current.Get("XmlSerializer")}a.prototype.Process=function(){var d=this.Router.GetMetadataUrl();var b=this.Transporter.Get(d);var c=this.PromiseFactory.Defer();b.Then(function(e){this.Metadata=this.XmlSerializer.Deserialize(e.data);c.Resolve(this.Metadata)},function(e){c.Reject("Metadata was not found at {0}.".replace("{0}",d))});return c.Promise};a.prototype.BuildContext=function(b){var c=this.Metadata["edmx:Edmx"];var j=c["@Version"];var h=c["edmx:DataServices"]["Schema"];var g;for(var e in g.EntityContainer.EntitySet){var d=g.EntityContainer.EntitySet[e];var f=d["@Name"];var i=new Set(f);b[f]=i}};return a})();var Router=(function(){function a(b){this.target="";this.expands=Enumerable.Empty();this.skip=0;this.take=0;this.count=false;this.Expand=function(c){var d=Enumerable.From(c.split(","));this.target=d.Last();this.expands=this.expands.Union(d)};this.Take=function(c){if(this.take){throw"Invalid Operation: Take can only be called once. "}this.take=c};this.Count=function(){if(this.count){throw"Invalid Operation: Count can only be called once. "}};this.OrderBy=function(c){if(this.orderby){throw"Invalid Operation: OrderBy can only be called once. "}};this.base=b.replace(/\/$/,"")}a.prototype.Route=function(c){c=c.replace(/^\//,"");var b="{base}/{relative}".replace("{base}",this.base).replace("{relative}",c);return b};a.prototype.GetRoute=function(b){var c="?";var e=this.selects[""];if(e.Any()){c=c.concat("$select={selection}&".replace("{selection}",e.ToArray().join(",")))}this.expands.ForEach(function(f){var g=this.selects[f];if(g){var h=g.ToArray().join(",");var i="$expand={expansion}($select={selection})&".replace("{expansion}",f).replace("{selection}",h);c=c.concat(i)}else{c=c.concat("$expand={expansion}&".replace("{expansion}",f))}});var d=this.Route(b+c);return d};a.prototype.GetMetadataUrl=function(){var b="{base}/{metadata}".replace("{base}",this.base).replace("{metadata}","$metadata");return b};a.prototype.Where=function(c,d,f){var e="{name} {operator} {value}";var b=e.replace("{name}",c).replace("{operator}",d).replace("{value}",f);this.filters.push(b)};a.prototype.Select=function(b){var c=Enumerable.From(b.split(","));var d=this.selects[this.target];if(!d){d=Enumerable.Empty()}this.selects[this.target]=d.Union(c)};a.prototype.ExpandAll=function(){};a.prototype.Skip=function(b){if(this.skip){throw"Invalid Operation: Skip can only be called once. "}this.skip=b};return a})();var Set=(function(){function a(b){this.Execute=function(){var e=this.Router.GetRoute(this.name);var d=this.PromiseFactory.Defer();var c=this.Transporter.Get(e);c.then(function(f){var g;if(this.Tracker){g=this.Tracker.Track(f.data.value)}else{g=f.data.value}d.resolve(g)},function(f){d.reject(f)});return d.promise};this.name=b;this.TrackerFactory=DependencyResolver.Current.GetFactory("Tracker");this.RouterFactory=DependencyResolver.Current.GetFactory("Router");this.PromiseFactory=DependencyResolver.Current.Get("PromiseFactory");this.Transporter=DependencyResolver.Current.Get("Transport");this.MetadataProvider=DependencyResolver.Current.Get("MetadataProvider")}a.prototype.Add=function(b){this.Tracker.Add(b)};a.prototype.Remove=function(b){this.Tracker.Remove(b)};a.prototype.Where=function(b,c,d){this.Router.Where(b,c,d);return this};a.prototype.Select=function(b){this.Router.Select(b);return this};a.prototype.Expand=function(b){if(this.expanded){throw"ExpandAll has already been called.  "}this.Router.Expand(b);return this};a.prototype.ExpandAll=function(){var b=true;var c=this.MetadataProvider.GetMetadata();this.Router.ExpandAll(c);return this};a.prototype.Skip=function(b){this.Router.Skip(b);return this};a.prototype.Take=function(b){this.Router.Take(b);return this};return a})();var Tracker=(function(){function a(){}a.prototype.Add=function(b){};a.prototype.Remove=function(b){};a.prototype.GetChanges=function(b){};return a})();var Validator=(function(){function a(){}return a})();var XmlSerializer=(function(){function a(){}a.prototype.Serialize=function(b){return""};a.prototype.Deserialize=function(b){return{}};a.prototype.ParseXml=function(b){};return a})();